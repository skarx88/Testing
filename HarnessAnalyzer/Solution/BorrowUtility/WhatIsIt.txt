The Borrow Utility is a standalone exe which can be used to borrow a license for the Browser from
a Flexlm license server.
It needs the lmborrow.exe from flexera and the borrow.exe along with the wrapper DLL Flmac.dll

The borrow.exe tries the checkout a license and returns it afterwards.
This finalizes the checkout process which is initiated by the BorrowUtility.exe using the lmborrow.exe
It was necessary to have this extra borrow.exe as the access via the license wrapper must be in en extra process
otherwise the consecutive checkout of the license in the case of an invalid license period failed.
This might be ommited if another solution can be found for this problem.

Beware that the license file must be in the same folder or at least to be found.
There are two versions of the Wrapper Flmac.dll for x64 / x86
These wrappers are copied from the libraries folder in the browser solution. 


The borrow utility copies the borrow.exe from the appropriate folder, so this solution must be first build in all configurations:
debug/release/x64/x86


Beware, the feature names are partly! case sensitive!!!!
In case a local borrowed entry cannot be returned the following might help:

On the client computer, log in as the user who borrowed the license.  Remember, this is case sensitive too.  You can verify by obtaining a license and checking the name in the debug log.
2.On the Windows Start menu, click Run (Windows 2000/XP) or Start>Search (Vista/Win 7).
3.Enter REGEDIT, and then click OK.
4.In the Registry Editor, navigate to the following registry key:      HKEY_CURRENT_USER\Software\FLEXlm License Manager\Borrow
5.In the Registry Editor, on the File menu, click Export to create a back up of this key.
6.Delete the HKEY_CURRENT_USER\Software\FLEXlm License Manager\Borrow registry key.
7.Close the Registry Editor.
8.Borrow the license again for the exact same product(s) and version(s) that you could not return.
9.Return the license(s) for each product. 
10.Check the license manager to ensure you no longer have any borrowed license.

-----------------------
Additional:
- The Project reference in BorrowUtility to BorrowHelper seems to be useless at first look. 
  But it's used to ensure correct build-order for test-solution and to force building the right borrowHelper that always fit's to the BorrowUtility (only building BorrowUtility is needed)
-----------------------


To operate the handling via a license server, the environment variable (formerly ECADLM..) ZUKEN_LICENSE_FILE needs to be set to 27000@erl-build01
If used from a VM the host file  (Windows\system32\drivers\etc\host) needs an entry to 10.7.0.126 erl-build01

